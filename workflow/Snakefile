from snakemake.utils import min_version
min_version("5.30.1")


configfile: "config/config.yaml"


include: "rules/common.smk"
include: "rules/junctions.smk"
include: "rules/sites.smk"
include: "rules/genome.smk"
include: "rules/pooled_sites.smk"
include: "rules/polyA.smk"
include: "rules/rates.smk"


rule all:
    input:
        expand("{out}/{p}R/{sample}.{p}R.gz", sample=SAMPLES, out=OUTPUT_DIR, p=POOLING_MODE),
        OUTPUT_DIR+"/aggregated_junction_stats.tsv"


rule J1:
    input:
        OUTPUT_DIR+"/aggregated_library_stats.tsv"

rule J:
    input:
        expand("{out}/J6/{sample}.J6.gz", sample=SAMPLES, out=OUTPUT_DIR),
        OUTPUT_DIR+"/aggregated_junction_stats.tsv"

rule S:
    input:
        expand("{out}/{p}S6/{sample}.{p}S6.gz", sample=SAMPLES, out=OUTPUT_DIR, p=POOLING_MODE),
        OUTPUT_DIR+"/aggregated_junction_stats.tsv"

rule A:
    input:
        expand("{out}/A2/{sample}.A2.gz", sample=SAMPLES, out=OUTPUT_DIR)
